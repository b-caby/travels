/*!
 *     ____  __  ______  __________ _    _____________       ____________
 *    / __ \/ / / / __ \/_  __/ __ \ |  / /  _/ ____/ |     / / ____/ __ \
 *   / /_/ / /_/ / / / / / / / / / / | / // // __/  | | /| / / __/ / /_/ /
 *  / ____/ __  / /_/ / / / / /_/ /| |/ // // /___  | |/ |/ / /___/ _, _/
 * /_/   /_/ /_/\____/ /_/  \____/ |___/___/_____/  |__/|__/_____/_/ |_|
 *
 * photoviewer - v3.10.1
 * A JS plugin to view images just like in Windows.
 * https://nzbin.github.io/photoviewer/
 *
 * Copyright (c) 2018-present nzbin
 * Released under MIT License
 */(function(Q,Z){typeof exports=="object"&&typeof module<"u"?module.exports=Z():typeof define=="function"&&define.amd?define(Z):(Q=typeof globalThis<"u"?globalThis:Q||self,Q.PhotoViewer=Z())})(this,function(){"use strict";function Q(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Z(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,It(n.key),n)}}function yi(t,i,e){return i&&Z(t.prototype,i),e&&Z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function k(t,i,e){return i=It(i),i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}function xi(t,i){if(typeof t!="object"||t===null)return t;var e=t[Symbol.toPrimitive];if(e!==void 0){var n=e.call(t,i||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(t)}function It(t){var i=xi(t,"string");return typeof i=="symbol"?i:String(i)}var s=function(t,i){return new s.fn.init(t,i)},H=window.document,P=[],bi=P.concat,Mi=P.filter,J=P.slice,wt={},yt={},zi={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},Rt=/^\s*<(\w+|!)[^>]*>/,Ti=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,_i=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Ot=/^(?:body|html)$/i,Ei=["val","css","html","text","data","width","height","offset"],xt=H.createElement("table"),At=H.createElement("tr"),Nt={tr:H.createElement("tbody"),tbody:xt,thead:xt,tfoot:xt,td:At,th:At,"*":H.createElement("div")},Ci=/^[\w-]*$/,bt={},Hi=bt.toString,kt=H.createElement("div"),tt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"},lt=H.documentElement.contains?function(t,i){return t!==i&&t.contains(i)}:function(t,i){for(;i&&(i=i.parentNode);)if(i===t)return!0;return!1};function it(t){return t==null?String(t):bt[Hi.call(t)]||"object"}function ft(t){return typeof t=="string"}function B(t){return it(t)=="function"}function et(t){return t!=null&&t==t.window}function Ft(t){return t!=null&&t.nodeType==t.DOCUMENT_NODE}function nt(t){return it(t)=="object"}function ot(t){return nt(t)&&!et(t)&&Object.getPrototypeOf(t)==Object.prototype}function Wt(t){var i=!!t&&"length"in t&&t.length,e=it(t);return e!="function"&&!et(t)&&(e=="array"||i===0||typeof i=="number"&&i>0&&i-1 in t)}function Li(t){return Mi.call(t,function(i){return i!=null})}function at(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function Bt(t,i){return typeof i=="number"&&!zi[at(t)]?i+"px":i}function jt(t){return t.replace(/-+(.)?/g,function(i,e){return e?e.toUpperCase():""})}function qt(t){return t in yt?yt[t]:yt[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function $i(t){var i,e;return wt[t]||(i=H.createElement(t),H.body.appendChild(i),e=getComputedStyle(i,"").getPropertyValue("display"),i.parentNode.removeChild(i),e=="none"&&(e="block"),wt[t]=e),wt[t]}function Si(t){return t.length>0?s.fn.concat.apply([],t):t}function ut(t){return t instanceof s}function Y(t,i,e,n){return B(i)?i.call(t,e,n):i}function Mt(t,i,e){e==null?t.removeAttribute(i):t.setAttribute(i,e)}function X(t,i){var e=t.className||"",n=e&&e.baseVal!==void 0;if(i===void 0)return n?e.baseVal:e;n?e.baseVal=i:t.className=i}function Vi(t,i){return t.nodeName&&t.nodeName.toLowerCase()===i.toLowerCase()}s.fn=s.prototype={constuctor:s,length:0,forEach:P.forEach,reduce:P.reduce,push:P.push,sort:P.sort,splice:P.splice,indexOf:P.indexOf,init:function(t,i){var e;if(t)if(typeof t=="string")if(t=t.trim(),t[0]=="<"&&Rt.test(t))e=s.fragment(t,RegExp.$1,i),t=null;else{if(i!==void 0)return s(i).find(t);e=s.qsa(H,t)}else{if(B(t))return s(H).ready(t);if(ut(t))return t;if(tt(t))e=Li(t);else if(nt(t))e=[t],t=null;else{if(i!==void 0)return s(i).find(t);e=s.qsa(H,t)}}else return this;return s.makeArray(e,t,this)},concat:function(){var t,i,e=[];for(t=0;t<arguments.length;t++)i=arguments[t],e[t]=ut(i)?i.toArray():i;return bi.apply(ut(this)?this.toArray():this,e)},pluck:function(t){return s.map(this,function(i){return i[t]})},toArray:function(){return this.get()},get:function(t){return t===void 0?J.call(this):this[t>=0?t:t+this.length]},size:function(){return this.length},each:function(t){return P.every.call(this,function(i,e){return t.call(i,e,i)!==!1}),this},map:function(t){return s(s.map(this,function(i,e){return t.call(i,e,i)}))},slice:function(){return s(J.apply(this,arguments))},first:function(){var t=this[0];return t&&!nt(t)?t:s(t)},last:function(){var t=this[this.length-1];return t&&!nt(t)?t:s(t)},eq:function(t){return t===-1?this.slice(t):this.slice(t,+t+1)}},s.extend=s.fn.extend=function(){var t,i,e,n,o,a,r=arguments[0]||{},h=1,u=arguments.length,f=!1;for(typeof r=="boolean"&&(f=r,r=arguments[h]||{},h++),typeof r!="object"&&!B(r)&&(r={}),h===u&&(r=this,h--);h<u;h++)if((t=arguments[h])!=null)for(i in t)e=r[i],n=t[i],r!==n&&(f&&n&&(ot(n)||(o=tt(n)))?(o?(o=!1,a=e&&tt(e)?e:[]):a=e&&ot(e)?e:{},r[i]=s.extend(f,a,n)):n!==void 0&&(r[i]=n));return r},s.extend({makeArray:function(t,i,e){var n,o=t?t.length:0;for(n=0;n<o;n++)e[n]=t[n];return e.length=o,e.selector=i||"",e},merge:function(t,i){for(var e=+i.length,n=0,o=t.length;n<e;n++)t[o++]=i[n];return t.length=o,t},qsa:function(t,i){var e,n=i[0]=="#",o=!n&&i[0]==".",a=n||o?i.slice(1):i,r=Ci.test(a);return t.getElementById&&r&&n?(e=t.getElementById(a))?[e]:[]:t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11?[]:J.call(r&&!n&&t.getElementsByClassName?o?t.getElementsByClassName(a):t.getElementsByTagName(i):t.querySelectorAll(i))},fragment:function(t,i,e){var n,o,a;return Ti.test(t)&&(n=s(H.createElement(RegExp.$1))),n||(t.replace&&(t=t.replace(_i,"<$1></$2>")),i===void 0&&(i=Rt.test(t)&&RegExp.$1),i in Nt||(i="*"),a=Nt[i],a.innerHTML=""+t,n=s.each(J.call(a.childNodes),function(){a.removeChild(this)})),ot(e)&&(o=s(n),s.each(e,function(r,h){Ei.indexOf(r)>-1?o[r](h):o.attr(r,h)})),n},matches:function(t,i){if(!i||!t||t.nodeType!==1)return!1;var e=t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(e)return e.call(t,i);var n,o=t.parentNode,a=!o;return a&&(o=kt).appendChild(t),n=~s.qsa(o,i).indexOf(t),a&&kt.removeChild(t),n},each:function(t,i){var e,n;if(Wt(t)){for(e=0;e<t.length;e++)if(i.call(t[e],e,t[e])===!1)return t}else for(n in t)if(i.call(t[n],n,t[n])===!1)return t;return t},map:function(t,i){var e,n=[],o,a;if(Wt(t))for(o=0;o<t.length;o++)e=i(t[o],o),e!=null&&n.push(e);else for(a in t)e=i(t[a],a),e!=null&&n.push(e);return Si(n)}}),s.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,i){bt["[object "+i+"]"]=i.toLowerCase()}),s.fn.init.prototype=s.fn;function Di(){}function Pi(t,i){if(arguments.length<2){var e=this[0];if(typeof t=="string")return e?e.style[jt(t)]||getComputedStyle(e,"").getPropertyValue(t):void 0;if(tt(t)){if(!e)return;var n={},o=getComputedStyle(e,"");return s.each(t,function(h,u){n[u]=e.style[jt(u)]||o.getPropertyValue(u)}),n}}var a="";if(it(t)=="string")!i&&i!==0?this.each(function(){this.style.removeProperty(at(t))}):a=at(t)+":"+Bt(t,i);else for(var r in t)!t[r]&&t[r]!==0?this.each(function(){this.style.removeProperty(at(r))}):a+=at(r)+":"+Bt(r,t[r])+";";return this.each(function(){this.style.cssText+=";"+a})}function Ii(t){return t?P.some.call(this,function(i){return this.test(X(i))},qt(t)):!1}function Ri(t){var i=[];return t?this.each(function(e){if("className"in this){i=[];var n=X(this),o=Y(this,t,e,n);o.split(/\s+/g).forEach(function(a){s(this).hasClass(a)||i.push(a)},this),i.length&&X(this,n+(n?" ":"")+i.join(" "))}}):this}function Oi(t){var i=[];return this.each(function(e){if("className"in this){if(t===void 0)return X(this,"");i=X(this),Y(this,t,e,i).split(/\s+/g).forEach(function(n){i=i.replace(qt(n)," ")}),X(this,i.trim())}})}function Ai(t){if(t)return this.each(function(e){var n=s(this),o=Y(this,t,e,n.offset()),a=n.offsetParent().offset(),r={top:o.top-a.top,left:o.left-a.left};n.css("position")=="static"&&(r.position="relative"),n.css(r)});if(!this.length)return null;if(H.documentElement!==this[0]&&!lt(H.documentElement,this[0]))return{top:0,left:0};var i=this[0].getBoundingClientRect();return{left:i.left+window.pageXOffset,top:i.top+window.pageYOffset,width:Math.round(i.width),height:Math.round(i.height)}}function Ni(){if(this.length){var t=this[0],i,e=this.offsetParent(),n=Ot.test(e[0].nodeName)?{top:0,left:0}:e.offset();return s(t).css("position")==="fixed"?i=t.getBoundingClientRect():(i=this.offset(),n.top+=parseFloat(s(e[0]).css("border-top-width"))||0,n.left+=parseFloat(s(e[0]).css("border-left-width"))||0),{top:i.top-n.top-parseFloat(s(t).css("margin-top"))||0,left:i.left-n.left-parseFloat(s(t).css("margin-left"))||0}}}function ki(t){if(this.length){var i="scrollTop"in this[0];return t===void 0?i?this[0].scrollTop:et(this[0])?this[0].pageYOffset:this[0].defaultView.pageYOffset:this.each(i?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}}function Fi(t){if(this.length){var i="scrollLeft"in this[0];return t===void 0?i?this[0].scrollLeft:et(this[0])?this[0].pageXOffset:this[0].defaultView.pageXOffset:this.each(i?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}}function Wi(){return this.map(function(){for(var t=this.offsetParent||H.body;t&&!Ot.test(t.nodeName)&&s(t).css("position")=="static";)t=t.offsetParent;return t})}function Bi(t,i){var e;return typeof t=="string"&&!(1 in arguments)?0 in this&&this[0].nodeType==1&&(e=this[0].getAttribute(t))!=null?e:void 0:this.each(function(n){if(this.nodeType===1)if(nt(t))for(var o in t)Mt(this,o,t[o]);else Mt(this,t,Y(this,i,n,this.getAttribute(t)))})}function ji(t){return this.each(function(){this.nodeType===1&&t.split(" ").forEach(function(i){Mt(this,i)},this)})}function qi(t){var i,e=this;return t?typeof t=="object"?i=s(t).filter(function(){var n=this;return P.some.call(e,function(o){return lt(o,n)})}):this.length==1?i=s(s.qsa(this[0],t)):i=this.map(function(){return s.qsa(this,t)}):i=s(),i}function Zi(t,i){var e=[],n=typeof t=="object"&&s(t);return this.each(function(o,a){for(;a&&!(n?n.indexOf(a)>=0:s.matches(a,t));)a=a!==i&&!Ft(a)&&a.parentNode;a&&e.indexOf(a)<0&&e.push(a)}),s(e)}function Yi(){var t=window.navigator.userAgent,i=t.indexOf("MSIE ");return i>0||!!navigator.userAgent.match(/Trident.*rv:11\./)}function Xi(t,i){var e={width:["padding-left","padding-right","border-left-width","border-right-width"],height:["padding-top","padding-bottom","border-top-width","border-bottom-width"]};return t.css("box-sizing")==="border-box"&&!Yi()?parseFloat(t.css(i))-parseFloat(t.css(e[i][0]))-parseFloat(t.css(e[i][1]))-parseFloat(t.css(e[i][2]))-parseFloat(t.css(e[i][3])):parseFloat(t.css(i))}function Zt(t,i){var e=t.replace(/./,function(o){return o[0].toUpperCase()}),n=this[0];return i===void 0?et(n)?n.document.documentElement["client"+e]:Ft(n)?n.documentElement["scroll"+e]:Xi(this,t):this.each(function(o){n=s(this),n.css(t,Y(this,i,o,n[t]()))})}function Ui(t){return Zt.call(this,"width",t)}function Ki(t){return Zt.call(this,"height",t)}var Gi=1,st={},Yt="onfocusin"in window,Xt={focus:"focusin",blur:"focusout"},Ut={mouseenter:"mouseover",mouseleave:"mouseout"},Qi=/^([A-Z]|returnValue$|layer[XY]$|webkitMovement[XY]$)/,Kt=function(){return!0},zt=function(){return!1},Ji={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};function rt(t){return t._zid||(t._zid=Gi++)}function Gt(t,i){if(i||!t.isDefaultPrevented){i||(i=t),s.each(Ji,function(e,n){var o=i[e];t[e]=function(){return this[n]=Kt,o&&o.apply(i,arguments)},t[n]=zt});try{t.timeStamp||(t.timeStamp=Date.now())}catch(e){console.warn(e)}(i.defaultPrevented!==void 0?i.defaultPrevented:"returnValue"in i?i.returnValue===!1:i.getPreventDefault&&i.getPreventDefault())&&(t.isDefaultPrevented=Kt)}return t}function Qt(t){var i=(""+t).split(".");return{e:i[0],ns:i.slice(1).sort().join(" ")}}function te(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function ie(t,i,e,n){if(i=Qt(i),i.ns)var o=te(i.ns);return(st[rt(t)]||[]).filter(function(a){return a&&(!i.e||a.e==i.e)&&(!i.ns||o.test(a.ns))&&(!e||rt(a.fn)===rt(e))&&(!n||a.sel==n)})}function Jt(t,i){return t.del&&!Yt&&t.e in Xt||!!i}function ti(t){return Ut[t]||Yt&&Xt[t]||t}function ee(t,i,e,n,o,a,r){var h=rt(t),u=st[h]||(st[h]=[]);i.split(/\s/).forEach(function(f){if(f=="ready")return s(H).ready(e);var p=Qt(f);p.fn=e,p.sel=o,p.e in Ut&&(e=function(l){var w=l.relatedTarget;if(!w||w!==this&&!lt(this,w))return p.fn.apply(this,arguments)}),p.del=a;var m=a||e;p.proxy=function(l){if(l=Gt(l),!l.isImmediatePropagationStopped()){l.data=n;var w=m.apply(t,l._args==null?[l]:[l].concat(l._args));return w===!1&&(l.preventDefault(),l.stopPropagation()),w}},p.i=u.length,u.push(p),"addEventListener"in t&&t.addEventListener(ti(p.e),p.proxy,Jt(p,r))})}function Tt(t,i,e,n,o){var a=rt(t);(i||"").split(/\s/).forEach(function(r){ie(t,r,e,n).forEach(function(h){delete st[a][h.i],"removeEventListener"in t&&t.removeEventListener(ti(h.e),h.proxy,Jt(h,o))})})}function ne(t){var i,e={originalEvent:t};for(i in t)!Qi.test(i)&&t[i]!==void 0&&(e[i]=t[i]);return Gt(e,t)}function ii(t,i){i(t);for(var e=0,n=t.childNodes.length;e<n;e++)ii(t.childNodes[e],i)}function oe(t,i,e,n){var o,a=s.map(i,function(u){var f=[];return o=it(u),o=="array"?(u.forEach(function(p){if(p.nodeType!==void 0)return f.push(p);if(ut(p))return f=f.concat(p.get());f=f.concat(s.fragment(p))}),f):o=="object"||u==null?u:s.fragment(u)}),r,h=t.length>1;return a.length<1?t:t.each(function(u,f){r=n?f:f.parentNode;var p=lt(H.documentElement,r);a.forEach(function(m){if(h)m=m.cloneNode(!0);else if(!r)return s(m).remove();e.call(f,m),p&&ii(m,function(l){if(l.nodeName!=null&&l.nodeName.toUpperCase()==="SCRIPT"&&(!l.type||l.type==="text/javascript")&&!l.src){var w=l.ownerDocument?l.ownerDocument.defaultView:window;w.eval.call(w,l.innerHTML)}})})})}function ae(t,i){var e;return typeof t.getElementsByTagName<"u"?e=t.getElementsByTagName(i||"*"):typeof t.querySelectorAll<"u"?e=t.querySelectorAll(i||"*"):e=[],i===void 0||i&&Vi(t,i)?s.merge([t],e):e}function se(t){for(var i,e,n=0;(e=t[n])!==void 0;n++)e._zid&&(i=st[e._zid])&&i.forEach(o=>{const a=o.e+"."+o.ns.split(" ").join(".");Tt(e,a,o.fn,o.sel)})}function re(){return this.each(function(){this.nodeType===1&&se(ae(this)),this.parentNode!=null&&this.parentNode.removeChild(this)})}function he(){return this.each(function(){this.innerHTML=""})}function le(t){return 0 in arguments?this.each(function(i){var e=this.innerHTML;s(this).empty().append(Y(this,t,i,e))}):0 in this?this[0].innerHTML:null}function fe(){return oe(this,arguments,function(t){this.insertBefore(t,null)},!0)}function ue(t,i,e,n,o){var a,r,h=this;return t&&!ft(t)?(s.each(t,function(u,f){h.on(u,i,e,f,o)}),h):(!ft(i)&&!B(n)&&n!==!1&&(n=e,e=i,i=void 0),(n===void 0||e===!1)&&(n=e,e=void 0),n===!1&&(n=zt),h.each(function(u,f){o&&(a=function(p){return Tt(f,p.type,n),n.apply(this,arguments)}),i&&(r=function(p){var m,l=s(p.target).closest(i,f).get(0);if(l&&l!==f)return m=s.extend(ne(p),{currentTarget:l,liveFired:f}),(a||n).apply(l,[m].concat(J.call(arguments,1)))}),ee(f,t,n,e,i,r||a)}))}function ce(t,i,e){var n=this;return t&&!ft(t)?(s.each(t,function(o,a){n.off(o,i,a)}),n):(!ft(i)&&!B(e)&&e!==!1&&(e=i,i=void 0),e===!1&&(e=zt),n.each(function(){Tt(this,t,e,i)}))}var O="",ct,de={Webkit:"webkit",Moz:"",O:"o"},dt=H.createElement("div"),ge=dt.style.transitionProperty;dt.style.transform===void 0&&s.each(de,function(t,i){if(dt.style[t+"TransitionProperty"]!==void 0)return O="-"+t.toLowerCase()+"-",ct=i,!1}),dt=null;function ei(t){return ct?ct+t:t.toLowerCase()}s.fx={off:ct===void 0&&ge===void 0,speeds:{_default:400,fast:200,slow:600},cssPrefix:O,transitionEnd:ei("TransitionEnd"),animationEnd:ei("AnimationEnd")};var pe=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,_t,ni,oi,ai,si,ri,hi,li,fi,F={};function ve(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}_t=O+"transform",F[ni=O+"transition-property"]=F[oi=O+"transition-duration"]=F[si=O+"transition-delay"]=F[ai=O+"transition-timing-function"]=F[ri=O+"animation-name"]=F[hi=O+"animation-duration"]=F[fi=O+"animation-delay"]=F[li=O+"animation-timing-function"]="";function me(t,i,e,n,o){var a,r={},h,u="",f=this,p,m=s.fx.transitionEnd,l=!1;if(i===void 0&&(i=s.fx.speeds._default/1e3),o===void 0&&(o=0),s.fx.off&&(i=0),typeof t=="string")r[ri]=t,r[hi]=i+"s",r[fi]=o+"s",r[li]=e||"linear",m=s.fx.animationEnd;else{h=[];for(a in t)pe.test(a)?u+=a+"("+t[a]+") ":(r[a]=t[a],h.push(ve(a)));u&&(r[_t]=u,h.push(_t)),i>0&&typeof t=="object"&&(r[ni]=h.join(", "),r[oi]=i+"s",r[si]=o+"s",r[ai]=e||"linear")}return p=function(w){if(typeof w<"u"){if(w.target!==w.currentTarget)return;s(w.target).off(m,p)}else s(this).off(m,p);l=!0,s(this).css(F),n&&n.call(this)},i>0&&(this.on(m,p),setTimeout(function(){l||p.call(f)},(i+o)*1e3+25)),this.size()&&this.get(0).clientLeft,this.css(r),i<=0&&setTimeout(function(){f.each(function(){p.call(this)})},0),this}function we(t,i,e,n,o){return B(i)&&(n=i,e=void 0,i=void 0),B(e)&&(n=e,e=void 0),ot(i)&&(e=i.easing,n=i.complete,o=i.delay,i=i.duration),i&&(i=(typeof i=="number"?i:s.fx.speeds[i]||s.fx.speeds._default)/1e3),o&&(o=parseFloat(o)/1e3),this.anim(t,i,e,n,o)}function ui(){return this.each(function(){this.style.display=="none"&&(this.style.display=""),getComputedStyle(this,"").getPropertyValue("display")=="none"&&(this.style.display=$i(this.nodeName))})}function ci(){return this.css("display","none")}function Et(t,i,e,n,o){typeof i=="function"&&!o&&(o=i,i=void 0);var a={opacity:e};return n&&(a.scale=n,t.css(s.fx.cssPrefix+"transform-origin","0 0")),t.animate(a,i,null,o)}function ye(t,i,e,n){return Et(t,i,0,e,function(){ci.call(s(this)),n&&n.call(this)})}function xe(t,i){return ui.call(this),t===void 0?t=0:this.css("opacity",0),Et(this,t,1,"1,1",i)}function be(t,i){return t===void 0?ci.call(this):ye(this,t,"0,0",i)}function Me(t,i,e){return Et(this,t,i,null,e)}function ze(t,i){var e=this.css("opacity");return e>0?this.css("opacity",0):e=1,ui.call(this).fadeTo(t,e,i)}var Te={isPlainObject:ot,isArray:tt,isFunction:B,noop:Di},_e={find:qi,closest:Zi,css:Pi,addClass:Ri,hasClass:Ii,removeClass:Oi,attr:Bi,removeAttr:ji,append:fe,remove:re,empty:he,html:le,width:Ui,height:Ki,scrollTop:ki,scrollLeft:Fi,offset:Ai,offsetParent:Wi,position:Ni,on:ue,off:ce,show:xe,hide:be,anim:me,animate:we,fadeTo:Me,fadeIn:ze};s.extend(Te),s.fn.extend(_e);var Ee={draggable:!0,resizable:!0,movable:!0,keyboard:!0,title:!0,modalWidth:320,modalHeight:320,fixedModalSize:!1,initMaximized:!1,gapThreshold:.02,ratioThreshold:.1,minRatio:.05,maxRatio:16,headerToolbar:["maximize","close"],footerToolbar:["zoomIn","zoomOut","prev","fullscreen","next","actualSize","rotateRight"],icons:{minimize:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M20,14H4V10H20"></path>
      </svg>`,maximize:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M4,4H20V20H4V4M6,8V18H18V8H6Z"></path>
      </svg>`,close:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M13.46,12L19,17.54V19H17.54L12,13.46L6.46,19H5V17.54L10.54,12
        L5,6.46V5H6.46L12,10.54L17.54,5H19V6.46L13.46,12Z"></path>
      </svg>`,zoomIn:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43
        C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5
        C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5
        C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z"></path>
      </svg>`,zoomOut:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5
        A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16
        C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14
        C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z"></path>
      </svg>`,prev:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M6,18V6H8V18H6M9.5,12L18,6V18L9.5,12Z"></path>
      </svg>`,next:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M16,18H18V6H16M6,18L14.5,12L6,6V18Z"></path>
      </svg>`,fullscreen:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M8.5,12.5L11,15.5L14.5,11L19,17H5M23,18V6A2,2 0 0,0 21,4H3
        A2,2 0 0,0 1,6V18A2,2 0 0,0 3,20H21A2,2 0 0,0 23,18Z"></path>
      </svg>`,actualSize:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M9.5,13.09L10.91,14.5L6.41,19H10V21H3V14H5V17.59L9.5,13.09
        M10.91,9.5L9.5,10.91L5,6.41V10H3V3H10V5H6.41L10.91,9.5M14.5,13.09L19,17.59V14H21V21H14V19
        H17.59L13.09,14.5L14.5,13.09M13.09,9.5L17.59,5H14V3H21V10H19V6.41L14.5,10.91
        L13.09,9.5Z"></path>
      </svg>`,rotateLeft:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M13,4.07V1L8.45,5.55L13,10V6.09C15.84,6.57 18,9.03 18,12
        C18,14.97 15.84,17.43 13,17.91V19.93C16.95,19.44 20,16.08 20,12C20,7.92 16.95,4.56 13,4.07
        M7.1,18.32C8.26,19.22 9.61,19.76 11,19.93V17.9C10.13,17.75 9.29,17.41 8.54,16.87L7.1,18.32
        M6.09,13H4.07C4.24,14.39 4.79,15.73 5.69,16.89L7.1,15.47C6.58,14.72 6.23,13.88 6.09,13
        M7.11,8.53L5.7,7.11C4.8,8.27 4.24,9.61 4.07,11H6.09C6.23,10.13 6.58,9.28 7.11,8.53Z"></path>
      </svg>`,rotateRight:`<svg viewBox="0 0 24 24" class="svg-inline-icon">
        <path fill="currentColor" d="M16.89,15.5L18.31,16.89C19.21,15.73 19.76,14.39 19.93,13H17.91
        C17.77,13.87 17.43,14.72 16.89,15.5M13,17.9V19.92C14.39,19.75 15.74,19.21 16.9,18.31
        L15.46,16.87C14.71,17.41 13.87,17.76 13,17.9M19.93,11C19.76,9.61 19.21,8.27 18.31,7.11
        L16.89,8.53C17.43,9.28 17.77,10.13 17.91,11M15.55,5.55L11,1V4.07C7.06,4.56 4,7.92 4,12
        C4,16.08 7.05,19.44 11,19.93V17.91C8.16,17.43 6,14.97 6,12C6,9.03 8.16,6.57 11,6.09V10
        L15.55,5.55Z"></path>
      </svg>`},i18n:{minimize:"Minimize",maximize:"Maximize (Alt+X)",close:"Close (Q)",zoomIn:"Zoom-in (+)",zoomOut:"Zoom-out (-)",prev:"Prev (\u2190)",next:"Next (\u2192)",fullscreen:"Fullscreen (F)",actualSize:"Actual-size (Ctrl+Alt+0)",rotateLeft:"Rotate-left (Ctrl+,)",rotateRight:"Rotate-right (Ctrl+.)"},multiInstances:!0,initAnimation:!0,animationDuration:400,animationEasing:"ease-in-out",fixedModalPos:!1,zIndex:1090,dragHandle:null,callbacks:{beforeOpen:s.noop,opened:s.noop,beforeClose:s.noop,closed:s.noop,beforeChange:s.noop,changed:s.noop},index:0,progressiveLoading:!0,appendTo:"body",customButtons:{},positionFixed:!0,initModalPos:null,errorMsg:""},di=window.document;function Ce(t,i){var e=null;return function(){var n=this,o=arguments;clearTimeout(e),e=setTimeout(function(){t.apply(n,o)},i)}}function He(t,i,e){var n=new Image;n.onload=function(){i(n)},n.onerror=function(){e(n)},n.src=t}function Le(t){t.requestFullscreen?t.requestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.msRequestFullscreen&&t.msRequestFullscreen()}function $e(t){var i=/^.*?\/*([^/?]*)\.[a-z]+(\?.+|$)/gi,e=t.replace(i,"$1");return e}function Ct(t,i,e,n){var o=n?t.h:t.w,a=n?t.w:t.h;(a>i.h||o>i.w)&&e.addClass("is-grab"),a<=i.h&&o<=i.w&&e.removeClass("is-grab")}function Ht(){return!!("ontouchstart"in window||window.DocumentTouch&&di instanceof window.DocumentTouch)}function gt(t){return/^(?:body|html)$/i.test(t.nodeName)}function pt(t,i){return i.reduce(function(e,n){return e+parseFloat(t.css(n))},0)}function ht(t){return t.css("box-sizing")==="border-box"}function gi(t,i,e,n,o){var a=1;return o?a=Math.min(e/i,n/t,1):a=Math.min(e/t,n/i,1),a}var vt=s(window),N=s(di),A="click",pi="resize",Se="keydown",Ve="wheel mousewheel DOMMouseScroll",Lt=Ht()?"touchstart":"mousedown",U=Ht()?"touchmove":"mousemove",K=Ht()?"touchend":"mouseup",d="photoviewer",_="."+d,x="."+d,D={isMoving:!1,isResizing:!1,zIndex:0};function De(t,i,e){var n=this,o=0,a=0,r=0,h=0,u=function(l){l=l||window.event,t[0].focus();var w=s(l.target).closest(e);if(w.length)return!0;n.options.multiInstances&&t.css("z-index",++D.zIndex),o=l.type==="touchstart"?l.targetTouches[0].pageX:l.clientX,a=l.type==="touchstart"?l.targetTouches[0].pageY:l.clientY,r=parseFloat(t.css("left")),h=parseFloat(t.css("top")),t.css({left:r,top:h,right:"",bottom:""}),N.on(U+x,f).on(K+x,p)},f=function(l){if(l=l||window.event,l.preventDefault(),!D.isMoving&&!D.isResizing&&!n.isMaximized){var w=l.type==="touchmove"?l.targetTouches[0].pageX:l.clientX,v=l.type==="touchmove"?l.targetTouches[0].pageY:l.clientY,z=w-o,c=v-a;t.css({left:z+r,top:c+h})}},p=function m(){N.off(U+x,f).off(K+x,m)};s(i).on(Lt+x,u)}var vi="html, body, .".concat(d,"-modal, .").concat(d,"-stage, .").concat(d,"-button, .").concat(d,"-resizable-handle");function Pe(t,i){var e=this,n=0,o=0,a=0,r=0,h=0,u=0,f=0,p=function(v){v=v||window.event,v.preventDefault();var z=i.width(),c=i.height(),b=t.width(),T=t.height();n=v.type==="touchstart"?v.targetTouches[0].pageX:v.clientX,o=v.type==="touchstart"?v.targetTouches[0].pageY:v.clientY,f=e.isRotated?(z-c)/2:0,h=e.isRotated?c-b:z-b,u=e.isRotated?z-T:c-T,D.isMoving=h>0||u>0,a=i.position().left-f,r=i.position().top+f,t.hasClass("is-grab")&&s(vi).addClass("is-grabbing"),N.on(U+x,m).on(K+x,l)},m=function(v){v=v||window.event,v.preventDefault();var z=v.type==="touchmove"?v.targetTouches[0].pageX:v.clientX,c=v.type==="touchmove"?v.targetTouches[0].pageY:v.clientY,b=z-n,T=c-o,g=b+a,S=T+r;u>0?T+r>f?S=f:T+r<-u+f&&(S=-u+f):S=r,h>0?b+a>-f?g=-f:b+a<-h-f&&(g=-h-f):g=a,i.css({left:g,top:S}),s.extend(e.imageData,{left:g,top:S})},l=function w(){N.off(U+x,m).off(K+x,w),D.isMoving=!1,s(vi).removeClass("is-grabbing")};t.on(Lt+x,p)}var mi="html, body, .".concat(d,"-modal, .").concat(d,"-stage, .").concat(d,"-button");function Ie(t,i,e,n){var o=this,a=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-e"></div>')),r=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-w"></div>')),h=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-s"></div>')),u=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-n"></div>')),f=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-se"></div>')),p=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-sw"></div>')),m=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-ne"></div>')),l=s('<div class="'.concat(d,"-resizable-handle ").concat(d,'-resizable-handle-nw"></div>')),w={e:a,s:h,se:f,n:u,w:r,nw:l,ne:m,sw:p};t.append(a,r,h,u,f,p,m,l);var v=0,z=0,c={w:0,h:0,x:0,y:0},b={w:0,h:0,x:0,y:0},T={w:0,h:0,x:0,y:0},g=0,S=0,W=0,G="",I=n.modalWidth,R=n.modalHeight,Re=function(M,y,L){var E=-y+c.w>I?y+c.x:c.x+c.w-I,C=-L+c.h>R?L+c.y:c.y+c.h-R,$={e:{width:Math.max(y+c.w,I)},s:{height:Math.max(L+c.h,R)},se:{width:Math.max(y+c.w,I),height:Math.max(L+c.h,R)},w:{width:Math.max(-y+c.w,I),left:E},n:{height:Math.max(-L+c.h,R),top:C},nw:{width:Math.max(-y+c.w,I),height:Math.max(-L+c.h,R),top:C,left:E},ne:{width:Math.max(y+c.w,I),height:Math.max(-L+c.h,R),top:C},sw:{width:Math.max(-y+c.w,I),height:Math.max(L+c.h,R),left:E}};return $[M]},Oe=function(M,y,L){var E=y+c.w>I?b.w-S+y-g:I-(c.w-b.w)-S-g,C=L+c.h>R?b.h-W+L+g:R-(c.h-b.h)-W+g,$=-y+c.w>I?b.w-S-y-g:I-(c.w-b.w)-S-g,V=-L+c.h>R?b.h-W-L+g:R-(c.h-b.h)-W+g,q=e.position().left,mt=e.position().top,St=(E>0?q:Math.min(q,0))-g,Vt=(C>0?mt:Math.min(mt,0))+g,Dt=($>0?q:Math.min(q,0))-g,Pt=(V>0?mt:Math.min(mt,0))+g,ke={e:{left:E>=-g?(E-g)/2:Math.max(St,E)},s:{top:C>=g?(C+g)/2:Math.max(Vt,C)},se:{top:C>=g?(C+g)/2:Math.max(Vt,C),left:E>=-g?(E-g)/2:Math.max(St,E)},w:{left:$>=-g?($-g)/2:Math.max(Dt,$)},n:{top:V>=g?(V+g)/2:Math.max(Pt,V)},nw:{top:V>=g?(V+g)/2:Math.max(Pt,V),left:$>=-g?($-g)/2:Math.max(Dt,$)},ne:{top:V>=g?(V+g)/2:Math.max(Pt,V),left:E>=-g?(E-g)/2:Math.max(St,E)},sw:{top:C>=g?(C+g)/2:Math.max(Vt,C),left:$>=-g?($-g)/2:Math.max(Dt,$)}};return ke[M]},Ae=function(M,y){y=y||window.event,y.preventDefault(),D.isResizing=!0,v=y.type==="touchstart"?y.targetTouches[0].pageX:y.clientX,z=y.type==="touchstart"?y.targetTouches[0].pageY:y.clientY,c={w:t.width()+(ht(t)?o._modalEdgeValue.horizontal:0),h:t.height()+(ht(t)?o._modalEdgeValue.vertical:0),x:t.position().left,y:t.position().top},b={w:i.width(),h:i.height(),x:i.position().left,y:i.position().top},T={w:e.width(),h:e.height(),x:e.position().left,y:e.position().top},g=o.isRotated?(T.w-T.h)/2:0,S=o.isRotated?T.h:T.w,W=o.isRotated?T.w:T.h,G=M,s(mi).css("cursor",M+"-resize"),N.on(U+x,wi).on(K+x,Ne)},wi=function(M){if(M=M||window.event,M.preventDefault(),!o.isMaximized){var y=M.type==="touchmove"?M.targetTouches[0].pageX:M.clientX,L=M.type==="touchmove"?M.targetTouches[0].pageY:M.clientY,E=y-v,C=L-z,$=Re(G,E,C);t.css($);var V=Oe(G,E,C);e.css(V)}},Ne=function j(){N.off(U+x,wi).off(K+x,j);var M=i.width(),y=i.height();D.isResizing&&Ct({w:S,h:W},{w:M,h:y},i),D.isResizing=!1,s(mi).css("cursor","");var L=o.imageData,E=L.originalWidth,C=L.originalHeight,$=gi(E,C,M,y,o.isRotated),V=E*$,q=C*$;s.extend(o.imageData,{initWidth:V,initHeight:q,initLeft:(M-V)/2,initTop:(y-q)/2})};s.each(w,function(j,M){M.on(Lt+x,function(y){Ae(j,y)})})}var $t=function(){function t(i,e){Q(this,t),k(this,"isOpened",!1),k(this,"isMaximized",!1),k(this,"isRotated",!1),k(this,"rotationDegree",0),k(this,"imageData",{}),k(this,"modalData",{width:null,height:null,left:null,top:null}),k(this,"prevIndex",null),k(this,"_lastTimestamp",0),this.init(i,e)}return yi(t,[{key:"init",value:function(e,n){this.options=s.extend(!0,{},Ee,n),n&&s.isArray(n.footerToolbar)&&(this.options.footerToolbar=n.footerToolbar),n&&s.isArray(n.headerToolbar)&&(this.options.headerToolbar=n.headerToolbar),D.zIndex=D.zIndex===0?this.options.zIndex:D.zIndex,this.open(),this.images=e,this.index=this.options.index,this._loadImage(this.index),this.options.draggable&&this.draggable(this.$photoviewer,this.dragHandle,_+"-button"),this.options.movable&&this.movable(this.$stage,this.$image),this.options.resizable&&this.resizable(this.$photoviewer,this.$stage,this.$image,this.options)}},{key:"_createBtns",value:function(e){var n=this,o=["minimize","maximize","close","zoomIn","zoomOut","prev","next","fullscreen","actualSize","rotateLeft","rotateRight"],a="";return s.each(e,function(r,h){var u="".concat(d,"-button ").concat(d,"-button-").concat(h);o.indexOf(h)>=0?a+='<button class="'.concat(u,'" title="').concat(n.options.i18n[h],`">
          `).concat(n.options.icons[h],`
          </button>`):n.options.customButtons[h]&&(a+='<button class="'.concat(u,'" title="').concat(n.options.customButtons[h].title||"",`">
          `).concat(n.options.customButtons[h].text,`
          </button>`))}),a}},{key:"_createTitle",value:function(){return this.options.title?'<div class="'.concat(d,'-title"></div>'):""}},{key:"_createTemplate",value:function(){var e='<div class="'.concat(d,`-modal" tabindex="0" role="dialog">
        <div class="`).concat(d,`-inner">
          <div class="`).concat(d,`-header">
            <div class="`).concat(d,"-toolbar ").concat(d,`-toolbar-header">
            `).concat(this._createBtns(this.options.headerToolbar),`
            </div>
            `).concat(this._createTitle(),`
          </div>
          <div class="`).concat(d,`-stage">
            <img class="`).concat(d,`-image" src="" alt="" />
          </div>
          <div class="`).concat(d,`-footer">
            <div class="`).concat(d,"-toolbar ").concat(d,`-toolbar-footer">
            `).concat(this._createBtns(this.options.footerToolbar),`
            </div>
          </div>
        </div>
      </div>`);return e.replace(/>\s+</g,"><")}},{key:"_build",value:function(){var e=this._createTemplate(),n=s(e);this.$photoviewer=n,this.$stage=n.find(_+"-stage"),this.$title=n.find(_+"-title"),this.$image=n.find(_+"-image"),this.$close=n.find(_+"-button-close"),this.$maximize=n.find(_+"-button-maximize"),this.$minimize=n.find(_+"-button-minimize"),this.$zoomIn=n.find(_+"-button-zoomIn"),this.$zoomOut=n.find(_+"-button-zoomOut"),this.$actualSize=n.find(_+"-button-actualSize"),this.$fullscreen=n.find(_+"-button-fullscreen"),this.$rotateLeft=n.find(_+"-button-rotateLeft"),this.$rotateRight=n.find(_+"-button-rotateRight"),this.$prev=n.find(_+"-button-prev"),this.$next=n.find(_+"-button-next"),this.$photoviewer.css("z-index",D.zIndex),this.options.positionFixed&&this.$photoviewer.css({position:"fixed"}),!this.options.dragHandle||this.options.dragHandle===_+"-modal"?this.dragHandle=this.$photoviewer:this.dragHandle=this.$photoviewer.find(this.options.dragHandle),s(this.options.appendTo).eq(0).append(this.$photoviewer),this._stageEdgeValue={horizontal:pt(this.$stage,["left","right","border-left-width","border-right-width"]),vertical:pt(this.$stage,["top","bottom","border-top-width","border-bottom-width"])},this._modalEdgeValue={horizontal:pt(this.$photoviewer,["padding-left","padding-right","border-left-width","border-right-width"]),vertical:pt(this.$photoviewer,["padding-top","padding-bottom","border-top-width","border-bottom-width"])},this._addEvents(),this._addCustomButtonEvents()}},{key:"open",value:function(){this._triggerHook("beforeOpen",this),!this.options.multiInstances&&t.instances.length>0&&t.instances[0].close(),this._build(),this._setInitModalPos(),t.instances.push(this),this._triggerHook("opened",this)}},{key:"close",value:function(){var e=this;this._triggerHook("beforeClose",this),this.$photoviewer.remove(),t.instances=t.instances.filter(function(n){return n!==e}),t.instances.length===0&&(D.zIndex=this.options.zIndex,vt.off(pi+x)),this._triggerHook("closed",this)}},{key:"_getOffsetParentData",value:function(){var e=s(this.options.appendTo)[0];return{width:this.options.positionFixed||gt(e)?vt.width():e.clientWidth,height:this.options.positionFixed||gt(e)?vt.height():e.clientHeight,scrollLeft:this.options.positionFixed?0:gt(e)?N.scrollLeft():e.scrollLeft,scrollTop:this.options.positionFixed?0:gt(e)?N.scrollTop():e.scrollTop}}},{key:"_setModalToCenter",value:function(){var e,n,o,a,r=0,h=0;if(ht(this.$photoviewer)||(r+=this._modalEdgeValue.horizontal,h+=this._modalEdgeValue.vertical),s.isPlainObject(this.options.initModalPos))e=this.options.initModalPos.left,n=this.options.initModalPos.top,o=this.options.initModalPos.right,a=this.options.initModalPos.bottom;else{var u=this._getOffsetParentData();e=(u.width-this.options.modalWidth-r)/2+u.scrollLeft,n=(u.height-this.options.modalHeight-h)/2+u.scrollTop}var f={width:this.modalData.width||this.options.modalWidth,height:this.modalData.height||this.options.modalHeight,left:this.modalData.left||e,top:this.modalData.top||n,right:this.modalData.right||o,bottom:this.modalData.bottom||a};this.$photoviewer.css(f)}},{key:"_setInitModalPos",value:function(){this.options.initMaximized?(this.maximize(),this.isOpened=!0):this._setModalToCenter(),this.$photoviewer[0].focus()}},{key:"_setModalSize",value:function(){var e=this,n=this.imageData.originalWidth+this._stageEdgeValue.horizontal,o=this.imageData.originalHeight+this._stageEdgeValue.vertical,a=0,r=0;ht(this.$photoviewer)?(n+=this._modalEdgeValue.horizontal,o+=this._modalEdgeValue.vertical):(a+=this._modalEdgeValue.horizontal,r+=this._modalEdgeValue.vertical);var h=this._getOffsetParentData(),u=Math.max(this.options.gapThreshold,0)+1,f=Math.min(h.width/((n+a)*u),h.height/((o+r)*u),1),p=Math.max(n*f,this.options.modalWidth),m=Math.max(o*f,this.options.modalHeight);p=this.options.fixedModalSize?this.options.modalWidth:Math.round(p),m=this.options.fixedModalSize?this.options.modalHeight:Math.round(m);var l,w,v,z;s.isPlainObject(this.options.initModalPos)?(l=this.options.initModalPos.left,w=this.options.initModalPos.top,v=this.options.initModalPos.right,z=this.options.initModalPos.bottom):(l=(h.width-p-a)/2+h.scrollLeft,w=(h.height-m-r)/2+h.scrollTop);var c={width:p,height:m,left:l,top:w,right:v,bottom:z};this.options.initAnimation?this.$photoviewer.animate(c,this.options.animationDuration,this.options.animationEasing,function(){e._setImageSize()}):(this.$photoviewer.css(c),this._setImageSize()),this.isOpened=!0}},{key:"_setImageSize",value:function(){var e=this.$stage.width(),n=this.$stage.height(),o=this.imageData,a=o.originalWidth,r=o.originalHeight,h=gi(a,r,e,n,this.isRotated),u=a*h,f=r*h;this.$image.css({width:Math.round(u),height:Math.round(f),left:(e-Math.round(u))/2,top:(n-Math.round(f))/2}),s.extend(this.imageData,{initWidth:u,initHeight:f,initLeft:(e-u)/2,initTop:(n-f)/2,width:u,height:f,left:(e-u)/2,top:(n-f)/2}),Ct({w:u,h:f},{w:e,h:n},this.$stage,this.isRotated),this.imageLoaded||(this.$photoviewer.find(_+"-loader").remove(),this.$stage.removeClass(d+"-align-center"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.fadeIn(),this.imageLoaded=!0,this._triggerHook("changed",[this,this.index]))}},{key:"_loadImage",value:function(e){var n,o,a=this;this.imageLoaded=!1,this._triggerHook("beforeChange",[this,this.prevIndex]),this._removeErrorMsg(),this.$image.removeAttr("style").attr("src",""),this.isRotated=!1,this.rotationDegree=0,this.$photoviewer.append('<div class="'.concat(d,'-loader"></div>')),this.$stage.addClass(d+"-align-center"),this.options.initAnimation&&!this.options.progressiveLoading&&this.$image.hide();var r=((n=this.images[e])===null||n===void 0?void 0:n.src)==null?"":this.images[e].src.toString();this.$image.attr("src",r);var h=((o=this.images[e])===null||o===void 0?void 0:o.title)||$e(r);this.options.title&&this.$title.html(h),this.$image.attr("alt",h),He(r,function(u){a.imageData={originalWidth:u.width,originalHeight:u.height},a.isMaximized||a.isOpened&&a.options.fixedModalPos?a._setImageSize():a._setModalSize()},function(){a.$photoviewer.find(_+"-loader").remove(),a._triggerHook("changed",[a,e]),a._setErrorMsg()})}},{key:"_setErrorMsg",value:function(){var e=s.isFunction(this.options.errorMsg)?this.options.errorMsg(this,this.index):this.options.errorMsg;e&&(this.$stage.append('<span class="'.concat(d,'-error-msg">').concat(e,"</span>")),this.$image.addClass(d+"-image-error"))}},{key:"_removeErrorMsg",value:function(){this.$stage.find(_+"-error-msg").remove(),this.$image.removeClass(d+"-image-error")}},{key:"jump",value:function(e){var n=Date.now();if(n-this._lastTimestamp>=this.options.animationDuration){var o=this.index+e;this.jumpTo(o),this._lastTimestamp=n}}},{key:"jumpTo",value:function(e){this.prevIndex=this.index;var n=e%this.images.length;n<=0&&(n=(n+this.images.length)%this.images.length),this.index=n,this._loadImage(this.index)}},{key:"_wheel",value:function(e){e.preventDefault();var n=1;e.deltaY?n=e.deltaY>0?1:-1:e.wheelDelta?n=-e.wheelDelta/120:e.detail&&(n=e.detail>0?1:-1);var o=-n*this.options.ratioThreshold,a={x:e.clientX-this.$stage.offset().left+N.scrollLeft(),y:e.clientY-this.$stage.offset().top+N.scrollTop()};this.zoom(o,a)}},{key:"zoom",value:function(e,n){e=e<0?1/(1-e):1+e,e=this.$image.width()/this.imageData.originalWidth*e,!(e>this.options.maxRatio||e<this.options.minRatio)&&this.zoomTo(e,n)}},{key:"zoomTo",value:function(e,n){var o=this.imageData,a=o.originalWidth,r=o.originalHeight,h=o.width,u=o.height,f=o.left,p=o.top,m=o.initWidth,l=this.$stage.width(),w=this.$stage.height();n===void 0&&(n={x:l/2,y:w/2});var v=a*e,z=r*e,c=n.x-(n.x-f)/h*v,b=n.y-(n.y-p)/u*z,T=this.isRotated?(v-z)/2:0,g=this.isRotated?z:v,S=this.isRotated?v:z,W=l-v,G=w-z;g<=l?c=W/2:c=c>-T?-T:Math.max(c,W+T),S<=w?b=G/2:b=b>T?T:Math.max(b,G-T),Math.abs(m-v)<m*.05?this._setImageSize():(this.$image.css({width:Math.round(v),height:Math.round(z),left:Math.round(c),top:Math.round(b)}),Ct({w:Math.round(g),h:Math.round(S)},{w:l,h:w},this.$stage)),s.extend(this.imageData,{width:v,height:z,left:c,top:b})}},{key:"rotate",value:function(e){this.rotationDegree=this.rotationDegree+e,this.rotationDegree/90%2===0?this.isRotated=!1:this.isRotated=!0,this.rotateTo(this.rotationDegree)}},{key:"rotateTo",value:function(e){this.$image.css({transform:"rotate("+e+"deg)"}),this._setImageSize()}},{key:"maximize",value:function(){this.$photoviewer.addClass(d+"-maximized"),this.$photoviewer.css({width:"auto",height:"auto",top:0,right:0,bottom:0,left:0}),this.isMaximized=!0}},{key:"exitMaximize",value:function(){this.$photoviewer.removeClass(d+"-maximized"),this._setModalToCenter(),this.isMaximized=!1}},{key:"toggleMaximize",value:function(){if(this.isMaximized)this.exitMaximize();else{var e=this.$photoviewer.width(),n=this.$photoviewer.height();ht(this.$photoviewer)&&(e+=this._modalEdgeValue.horizontal,n+=this._modalEdgeValue.vertical),this.modalData={width:e,height:n,left:parseFloat(this.$photoviewer.css("left")),top:parseFloat(this.$photoviewer.css("top"))},this.maximize()}this._setImageSize(),this.$photoviewer[0].focus()}},{key:"fullscreen",value:function(){Le(this.$photoviewer[0]),this.$photoviewer[0].focus()}},{key:"resize",value:function(){this.isOpened&&(this.isMaximized?this._setImageSize():this._setModalSize())}},{key:"_keydown",value:function(e){if(this.options.keyboard){var n=e.keyCode||e.which||e.charCode,o=e.ctrlKey||e.metaKey,a=e.altKey;switch(n){case 37:this.jump(-1);break;case 39:this.jump(1);break;case 187:this.zoom(this.options.ratioThreshold*3,{x:this.$stage.width()/2,y:this.$stage.height()/2},e);break;case 189:this.zoom(-this.options.ratioThreshold*3,{x:this.$stage.width()/2,y:this.$stage.height()/2},e);break;case 61:this.zoom(this.options.ratioThreshold*3,{x:this.$stage.width()/2,y:this.$stage.height()/2},e);break;case 173:this.zoom(-this.options.ratioThreshold*3,{x:this.$stage.width()/2,y:this.$stage.height()/2},e);break;case 48:o&&a&&this.zoomTo(1,{x:this.$stage.width()/2,y:this.$stage.height()/2},e);break;case 188:o&&(e.preventDefault(),this.rotate(-90));break;case 190:o&&this.rotate(90);break;case 81:this.close();break;case 88:a&&this.toggleMaximize();break;case 70:this.fullscreen();break}}}},{key:"_addEvents",value:function(){var e=this;this.$close.on(A+x,function(){e.close()}),this.$stage.on(Ve+x,function(n){e._wheel(n)}),this.$zoomIn.on(A+x,function(){e.zoom(e.options.ratioThreshold*3)}),this.$zoomOut.on(A+x,function(){e.zoom(-e.options.ratioThreshold*3)}),this.$actualSize.on(A+x,function(){e.zoomTo(1)}),this.$prev.on(A+x,function(){e.jump(-1)}),this.$next.on(A+x,function(){e.jump(1)}),this.$rotateLeft.on(A+x,function(){e.rotate(-90)}),this.$rotateRight.on(A+x,function(){e.rotate(90)}),this.$maximize.on(A+x,function(){e.toggleMaximize()}),this.$fullscreen.on(A+x,function(){e.fullscreen()}),this.$photoviewer.on(Se+x,function(n){e._keydown(n)}),vt.on(pi+x,Ce(function(){return e.resize()},500))}},{key:"_addCustomButtonEvents",value:function(){var e=this,n=function(r){e.$photoviewer.find(_+"-button-"+r).on(A+x,function(h){e.options.customButtons[r].click.apply(e,[e,h])})};for(var o in this.options.customButtons)n(o)}},{key:"_triggerHook",value:function(e,n){this.options.callbacks[e]&&this.options.callbacks[e].apply(this,s.isArray(n)?n:[n])}}]),t}();return k($t,"instances",[]),s.extend($t.prototype,{draggable:De},{movable:Pe},{resizable:Ie}),$t});
